# 共通コンポーネント開発 - Issue

## 基本情報

- **作成日**: 2024-11-02
- **担当者**: プロジェクトチーム
- **優先度**: High
- **種別**: Feature

## 問題・要件概要

プロジェクト全体で使用する共通コンポーネントとカスタムフックが必要。Phase 3 以降の機能実装の基盤となるため、再利用可能で保守性の高いコンポーネントを実装する。

## 詳細説明

### 現状

- Phase 1 でプロジェクト基盤は整備済み
- 各ページはプレースホルダー実装のみ
- 共通コンポーネントが存在せず、UI の一貫性が担保できない
- Tailwind CSS がインストールされているが使用方針が未決定

### 要求事項

#### 1. Layout コンポーネント

**目的**: 全ページで統一されたレイアウトを提供

**機能要件**:

- ヘッダー（アプリタイトル、ナビゲーションメニュー）
- メインコンテンツエリア（children プロパティ）
- レスポンシブ対応（モバイル・タブレット・デスクトップ）
- ナビゲーションリンク（Home, Template, Data Input）

**非機能要件**:

- Chrome Book での表示最適化
- アクセシビリティ対応（semantic HTML）
- CSS Modules でスタイリング

#### 2. Button コンポーネント

**目的**: 統一されたボタン UI の提供

**機能要件**:

- variant: 'primary' | 'secondary' | 'danger'
- size: 'small' | 'medium' | 'large'
- disabled 状態のサポート
- onClick ハンドラー
- label または children でテキスト表示

**非機能要件**:

- アクセシビリティ対応（ARIA 属性、キーボード操作）
- ホバー・フォーカス・アクティブ状態のスタイル
- レスポンシブ（タッチデバイス対応）

#### 3. useLocalStorage カスタムフック

**目的**: 型安全な localStorage 操作の提供

**機能要件**:

- useState と同様の API
- 型パラメータで型安全性を確保
- 自動的な JSON シリアライズ/デシリアライズ
- 初期値のサポート
- エラーハンドリング

**非機能要件**:

- React の再レンダリング最適化
- localStorage 容量エラーのハンドリング

#### 4. Modal コンポーネント

**目的**: ダイアログ・確認画面の表示

**機能要件**:

- isOpen プロパティで表示制御
- onClose コールバック
- title プロパティ
- children でコンテンツ表示
- オーバーレイクリックで閉じる
- ESC キーで閉じる
- フォーカストラップ（モーダル内でのタブ移動）

**非機能要件**:

- アクセシビリティ対応（role="dialog", aria-modal）
- z-index 管理
- 背景スクロール防止

#### 5. Toast/Notification コンポーネント

**目的**: ユーザーへのフィードバック表示

**機能要件**:

- type: 'success' | 'error' | 'warning' | 'info'
- message プロパティ
- 自動消去（デフォルト 3 秒、カスタマイズ可能）
- 手動で閉じる機能
- 複数トーストの同時表示
- useNotification フックでの簡単な呼び出し

**非機能要件**:

- 画面右上に固定表示
- アニメーション（フェードイン・フェードアウト）
- z-index 管理

### 受け入れ条件

- [ ] Layout コンポーネントが実装され、全ページで使用されている
- [ ] Button コンポーネントが実装され、各 variant/size が正常に動作する
- [ ] useLocalStorage フックが実装され、型安全に動作する
- [ ] Modal コンポーネントが実装され、開閉・フォーカス管理が正常に動作する
- [ ] Toast コンポーネントと useNotification フックが実装され、通知が表示される
- [ ] すべてのコンポーネントに `.spec.md` が存在する
- [ ] すべてのコンポーネントにテストが実装され、合格する
- [ ] TypeScript エラーがない
- [ ] Biome チェックエラーがない
- [ ] DEPENDENCY MAP が全ファイルに記載されている
- [ ] レガシーファイル（APITester.tsx, frontend.tsx, index.tsx）が削除されている

## 影響範囲

### ユーザー

- UI の一貫性が向上
- 操作性が向上（統一されたボタン、フィードバック）

### システム

- 新規ファイル: 約 20 ファイル（コンポーネント、テスト、仕様書）
- 修正ファイル: 3 ページコンポーネント（Layout 適用）
- 削除ファイル: 3 レガシーファイル

### 他機能

- Phase 3 以降の全機能で共通コンポーネントを使用
- テンプレート管理・データ入力機能の開発効率向上

## 関連ドキュメント

- Prompt: `docs/00_prompts/20241102_02_phase2-common-components.md`
- Plan: `docs/03_plans/overall/20241102_01_project-overall-plan.md`
- Phase 1 Log: `docs/05_logs/2024_11/20241102/02_phase1-implementation-completed.md`

## 解決状況

- [ ] 要件分析完了
- [ ] 技術調査完了（不要 - 既存技術スタックで実装）
- [ ] 実装計画完了（全体計画に含まれる）
- [ ] 実装完了
- [ ] テスト完了
- [ ] レビュー完了
